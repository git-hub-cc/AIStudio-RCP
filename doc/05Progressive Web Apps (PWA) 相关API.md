### **PWA (Progressive Web Apps) 相关API分类大全 (第一部分)**

**前言**

Progressive Web Apps (PWA) 是一系列现代Web技术的集合，旨在让Web应用在功能、可靠性和体验上媲美原生应用。其核心能力由众多Web API提供支持。本文档旨在对这些关键API进行系统性分类和介绍，帮助开发者构建功能强大的PWA。

---

### **I. PWA核心基础 (Core Foundation)**

此类API构成了PWA的基石，是实现“可安装”和“可靠”特性的前提。

*   **Web App Manifest API**
    此API通过一个JSON文件（manifest.json）向浏览器提供应用信息，如名称、图标、启动URL、显示模式等，使得Web应用可以被“添加至主屏幕”或“安装”，获得类似原生应用的入口。

*   **Service Worker API**
    作为浏览器与网络间的可编程代理，它在独立的后台线程中运行，能拦截和处理网络请求。这是实现离线缓存、消息推送、后台同步等高级功能的核心，是PWA技术栈的绝对基石。

*   **Fetch API**
    一个现代、强大且灵活的网络请求接口，用于替代传统的XMLHttpRequest。它基于Promise，语法简洁，并且是Service Worker拦截和响应网络请求的标准工具，与PWA开发紧密相关。

*   **Cache API**
    提供一个由Service Worker控制的请求和响应对象的存储机制。开发者可以用它精细地管理缓存内容，实现动态缓存策略，是构建离线优先应用的关键工具，与Service Worker配合使用。

*   **Push API**
    允许服务器向PWA发送推送消息，即使用户当前没有打开该应用。它依赖于Service Worker来接收和处理消息，是实现用户再次参与(Re-engagement)的重要手段。

*   **Notifications API**
    用于在操作系统层面显示通知。通常与Push API结合使用，当Service Worker接收到推送消息后，调用此API向用户展示可见的通知提醒，即使用户的浏览器或PWA已关闭。

---

### **II. 离线与存储 (Offline & Storage)**

这些API为PWA提供了在离线或网络不佳时仍能正常运行，并持久化应用数据的能力。

*   **IndexedDB API**
    一个功能强大的客户端非关系型（NoSQL）数据库，用于在浏览器中存储大量结构化数据，支持事务和索引。它是PWA存储复杂应用数据、实现离线功能的首选方案。

*   **Web Storage API (LocalStorage / SessionStorage)**
    提供了简单的键值对存储机制。LocalStorage用于持久化存储，数据在浏览器会话间共享；SessionStorage则仅在当前会-话期间有效。适合存储少量、非结构化的数据，如用户偏好设置。

*   **Background Sync API**
    允许PWA将网络操作（如发送表单）推迟到浏览器恢复稳定网络连接时再执行。即使用户在离线时提交数据，应用也能确保数据最终会成功同步，极大地提升了离线用户体验。

*   **Periodic Background Sync API**
    作为Background Sync的扩展，它允许PWA注册周期性任务，在应用未打开时，浏览器会定期（如每天一次）在后台唤醒Service Worker执行数据同步等任务，如更新新闻内容。

*   **Storage Manager API**
    用于管理站点可用的存储空间。它允许应用查询当前已用空间和总配额，并可以请求将数据设置为“持久化存储”，防止浏览器在存储空间不足时自动清理数据，保障核心离线数据的安全。

*   **Content Indexing API**
    允许PWA向浏览器注册其重要的、可离线访问的内容。浏览器可能会利用这些信息在特定UI（如Chrome的“下载”页面）中展示，让用户更容易发现和访问应用的离线内容。

---

### **III. 系统集成与原生体验 (System Integration & Native Experience)**

此类API旨在打破Web与操作系统的边界，让PWA能够像原生应用一样与系统深度集成。

*   **Badging API**
    允许已安装的PWA在应用图标上显示一个“角标”（badge），通常用于展示未读消息数量或状态更新。这为用户提供了直观的信息提示，是原生应用中常见的交互模式。

*   **Web Share API**
    调用操作系统的原生分享对话框，让用户可以将文本、链接或文件分享到设备上已安装的其他应用（如社交媒体、邮件客户端）。这提供了比自定义分享菜单更统一、更强大的分享体验。

*   **Web Share Target API**
    与Web Share API相反，它允许PWA注册为“分享目标”。当用户在其他应用中分享内容时，该PWA可以出现在系统的分享候选项中，从而接收并处理分享过来的数据。

*   **Clipboard API**
    提供对系统剪贴板的异步读写能力。相比传统的`document.execCommand`，它更安全、功能更强大，支持复制和粘贴文本、图片等多种数据类型，并有完善的权限控制。

*   **Contact Picker API**
    以一种保护隐私的方式，允许Web应用访问用户的设备通讯录。它会弹出系统原生的联系人选择器，由用户主动选择一个或多个联系人信息分享给应用，应用无法直接遍历整个通讯录。

*   **File System Access API**
    允许Web应用直接与用户本地文件系统进行交互，可以读取、写入甚至创建文件和文件夹。这为开发功能强大的Web IDE、图像编辑器、文本处理器等应用提供了可能，需要用户明确授权。

*   **App Shortcuts API**
    允许为已安装的PWA定义一组快捷操作。在支持的操作系统上（如Android或Windows），用户通过长按或右键点击PWA图标，即可看到并直接访问这些预设的核心功能。

*   **URL Protocol Handler API**
    允许PWA将自身注册为特定URL协议（如`web+music://`）的处理程序。当用户点击这类链接时，操作系统可以直接唤起对应的PWA来处理该请求，实现应用间的深度链接。

*   **Fullscreen API**
    提供以编程方式让页面或特定元素进入全屏模式的能力。这对于游戏、视频播放器或演示文稿类应用非常有用，可以提供沉浸式的用户体验，消除浏览器UI的干扰。

*   **Screen Wake Lock API**
    当PWA需要持续显示时（如菜谱、导航或演示应用），可以使用此API来阻止设备屏幕自动变暗或锁定。这避免了用户需要频繁触摸屏幕以保持其亮起，提升了可用性。


### **IV. 硬件与传感器 (Hardware & Sensors)**

这些API使得Web应用能够访问设备硬件和传感器数据，从而创造出更丰富、更具情境感知能力的用户体验。

*   **Geolocation API**
    提供访问设备地理位置信息的能力。通过用户授权，Web应用可以获取经纬度、海拔、速度等数据，广泛用于地图、导航、本地化服务等场景。

*   **Media Devices API (`getUserMedia`)**
    允许Web应用请求访问用户的摄像头和麦克风。这是实现Web端视频会议、拍照、录音等功能的基础，需要用户明确授权才能获取媒体流。

*   **Device Orientation Events API**
    提供有关设备物理方向的信息，包括三个轴向的角度（alpha, beta, gamma）。可用于实现360度全景视图、体感控制游戏或罗盘等应用。

*   **Device Motion Events API**
    提供设备加速度和旋转速率的相关数据。通过监听`devicemotion`事件，可以实现“摇一摇”等基于设备运动的交互功能，增强应用的趣味性。

*   **Vibration API**
    允许Web应用控制设备的振动功能。通过一个简单的调用，可以触发一次或一系列的振动模式，常用于游戏反馈或消息提醒，以提供触觉反馈。

*   **Web Bluetooth API**
    使Web应用能够发现并连接附近的蓝牙低功耗（BLE）设备。通过用户授权，可以与心率监测器、智能灯泡等物联网设备进行通信，极大地扩展了Web的连接能力。

*   **WebUSB API**
    允许Web应用与USB设备进行通信。在用户授权后，网页可以直接与打印机、开发板、硬件钱包等设备交互，为专业和开发者工具类应用打开了新的大门。

*   **WebNFC API (Near Field Communication)**
    使Web应用能够通过近场通信技术读写NFC标签。用户将设备靠近NFC标签时，PWA可以读取标签信息或向其写入数据，适用于支付、签到、设备配对等场景。

*   **Ambient Light Sensor API**
    提供对设备光线传感器的访问，允许Web应用获取当前环境的光照强度（以勒克斯为单位）。可用于根据环境光自动调整应用的主题亮度，提升阅读舒适度。

*   -**Proximity Sensor API**
    允许Web应用检测物体与设备屏幕的接近程度。例如，当用户接听电话将手机贴近耳朵时，可以利用此API自动关闭屏幕以防误触，类似于原生通话应用。

*   **Battery Status API**
    提供有关设备电池状态的信息，包括电量百分比、是否正在充电以及预计剩余时间。应用可以根据电量情况调整自身行为，如在低电量时进入节能模式。

*   **Pointer Lock API**
    允许应用锁定鼠标指针在特定元素内，并隐藏指针图标。这对于第一人称游戏或3D建模应用至关重要，可以提供无边界的、沉浸式的鼠标控制体验。

---

### **V. 多媒体与通信 (Multimedia & Communication)**

此类API专注于处理音频、视频、实时通信和媒体控制，让PWA在多媒体领域拥有媲美原生应用的能力。

*   **WebRTC (Web Real-Time Communications)**
    一个强大的框架，允许浏览器之间建立点对点的实时音视频和数据通信，无需任何插件。它是构建在线视频会议、直播、文件共享等应用的基石。

*   **Media Session API**
    允许Web应用自定义媒体播放在操作系统通知中心、锁屏界面或可穿戴设备上的显示信息和控件。用户可以通过系统UI控制PWA的媒体播放，体验无缝衔接。

*   **Picture-in-Picture API**
    允许将正在播放的视频元素置于一个可悬浮于所有窗口之上的小窗口中。即使用户切换到其他应用或标签页，视频依然可见，极大地提升了多任务处理体验。

*   **Screen Capture API**
    提供捕获用户屏幕、特定应用窗口或浏览器标签页内容为媒体流的能力。常用于构建屏幕录制、远程协助或在线演示等应用，需要用户明确授权。

*   **Encrypted Media Extensions (EME)**
    一个提供内容保护的API，使Web应用能够播放受数字版权管理（DRM）保护的加密媒体。它是Netflix、YouTube等流媒体服务在Web上提供高清受保护内容的关键。

*   **Web Audio API**
    一个用于在Web应用中处理和合成音频的高级JavaScript API。它提供了非常精细的音频控制能力，可用于开发游戏音效、音乐合成器、音频可视化等复杂应用。

---

### **VI. 性能与优化 (Performance & Optimization)**

这些API帮助开发者监测和提升PWA的性能，确保应用运行流畅、响应迅速。

*   **Web Workers API**
    允许在主线程之外的后台线程中执行JavaScript代码。这可以将计算密集型或耗时的任务移出主线程，避免UI冻结，从而保证应用的流畅性和响应性。

*   **Intersection Observer API**
    提供一种异步、高效的方式来监测目标元素与其祖先元素或顶级视口的交叉状态。非常适合实现图片懒加载、无限滚动、广告曝光统计等功能，且性能开销极低。

*   **Resize Observer API**
    用于监视元素尺寸的变化。相比传统的事件监听，它能提供更精确、性能更好的尺寸变化通知，非常适合用于构建复杂的响应式布局或动态调整组件。

*   **Page Visibility API**
    允许应用判断页面当前是否对用户可见。当页面被隐藏时，应用可以暂停播放视频、停止动画或减少网络请求，从而节省CPU和电量资源，优化用户体验。

*   **`requestIdleCallback` API**
    允许开发者安排一个回调函数在浏览器主线程处于空闲状态时执行。适合处理可延迟的、非关键性的后台任务（如数据上报），避免与用户交互或动画渲染等高优先级任务争抢资源。

*   **Performance API**
    提供了一套精确测量Web应用性能的工具。开发者可以用它来获取高精度时间戳、记录性能标记、测量代码执行时间等，是进行性能分析和优化的重要依据。

好的，这是 PWA 相关 API 分类大全的第三部分。在这一部分，我们将聚焦于应用的安全性、用户体验增强、高级数据处理以及一些新兴的前沿技术。

---

### **PWA (Progressive Web Apps) 相关API分类大全 (第三部分)**

---

### **VII. 身份验证与安全 (Authentication & Security)**

这些API为PWA提供了现代、安全的用户身份验证机制和客户端数据保护能力，是构建可信赖应用的基础。

*   **Web Authentication API (WebAuthn)**
    提供基于公钥加密的安全、无密码身份验证。用户可通过生物识别（指纹、面容）或硬件安全密钥（如YubiKey）登录，极大提升应用安全性，并彻底摆脱密码泄露风险。

*   **Credential Management API**
    简化了登录流程，允许PWA以编程方式请求、存储和检索用户凭据。它支持一键登录和自动登录功能，显著减少用户登录时的操作摩擦，提升用户体验和转化率。

*   **Web Cryptography API**
    提供了一套低级别的加密功能，允许Web应用在客户端执行哈希、签名、加密、解密等密码学操作。这对于保护用户数据、实现端到端加密等安全敏感型功能至关重要。

*   **Subresource Integrity (SRI)**
    一项安全特性，允许浏览器验证从外部源（如CDN）获取的资源（如脚本或样式表）是否被篡改。通过在`<script>`或`<link>`标签中提供文件哈希值，确保代码的完整性。

*   **Content Security Policy (CSP)**
    一种增加的安全层，帮助检测和缓解某些类型的攻击，例如跨站脚本（XSS）和数据注入。通过定义信任的内容源，限制浏览器只能加载和执行来自这些源的资源。

---

### **VIII. UI/UX 增强与渲染 (UI/UX Enhancement & Rendering)**

此类API致力于提升PWA的视觉表现和交互流畅度，使其在外观和感觉上更接近原生应用。

*   **View Transitions API**
    为单页面应用（SPA）提供页面间平滑的视图过渡动画。它能自动处理元素状态变化，让开发者轻松实现类似原生应用的无缝切换效果，极大提升视觉连贯性和用户体验。

*   **Popover API**
    一个用于构建“顶层”UI组件（如菜单、对话框、提示框）的声明式API。它自动处理可访问性、焦点管理和堆叠顺序，使创建高质量、行为一致的弹出式界面变得异常简单。

*   **CSS Media Queries Level 5**
    包括`prefers-color-scheme`和`prefers-reduced-motion`等特性。让PWA能够响应用户的操作系统级偏好，如自动切换到深色模式或减少动画效果，实现更个性化和无障碍的体验。

*   **Web Animations API (WAAPI)**
    提供了一套强大且性能优越的JavaScript API，用于创建复杂的、可精确控制的动画。相比CSS动画，它提供了更灵活的动态控制能力，是实现高级交互动效的利器。

*   **Scroll-to-Text Fragment**
    允许URL指定并直接导航到页面中的特定文本片段。浏览器会自动滚动到该文本并高亮显示，极大地增强了PWA内容的可链接性和分享精度，便于引用和定位信息。

*   **Idle Detection API**
    当用户处于非活动状态（如未与键盘、鼠标或屏幕交互）时通知Web应用。应用可利用此信息执行低优先级任务，或在用户离开时改变状态（如聊天应用设为“离开”）。

---

### **IX. 高级连接与数据处理 (Advanced Connectivity & Data Handling)**

这些API为PWA提供了更高效、更强大的网络通信和数据处理能力，适用于实时、高性能或大数据量场景。

*   **Background Fetch API**
    专为在后台可靠地下载或上传大量文件而设计。即使用户关闭PWA或浏览器，传输任务也会继续。非常适合实现离线媒体下载、软件更新包分发等功能。

*   **WebSocket API**
    在客户端和服务器之间建立一个持久的、全双工的通信通道。它适用于需要低延迟、高频率数据交换的实时应用，如在线聊天、多人游戏、股票行情更新等。

*   **WebTransport API**
    作为WebSocket的现代替代方案，基于HTTP/3。它提供多个数据流、支持有序和无序传输、以及可靠和不可靠消息，为实时游戏、流媒体等应用提供了更灵活、更高效的通信能力。

*   **WebAssembly (Wasm)**
    一种可移植的、体积小、加载快的二进制指令格式，可作为Web应用的编译目标。它允许将C++、Rust等语言编写的高性能代码运行在浏览器中，适用于计算密集型任务，如3D渲染、视频编辑等。

*   **Streams API**
    提供处理数据流（如网络响应、文件读写）的标准API。它允许数据在完全可用之前就分块进行处理，有效降低内存占用，并能通过管道（Piping）组合操作，提高数据处理效率。

*   **Remote Playback API**
    允许Web应用将其媒体内容“投射”到支持的远程播放设备（如智能电视、Chromecast）。用户可以在大屏幕上享受PWA中的视频或音频内容，扩展了应用的使用场景。

