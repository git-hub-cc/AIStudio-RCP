### 1. **`chrome.pageCapture` - 页面完整存档**

**功能**：把整个标签页保存为 MHTML 文件。
只能在后台脚本 (service worker) 或扩展脚本里调用。

**示例**：

```jsonc
// manifest.json
{
  "name": "PageCapture Demo",
  "manifest_version": 3,
  "version": "1.0",
  "permissions": ["pageCapture", "downloads", "tabs"],
  "background": {
    "service_worker": "background.js"
  }
}
```

```js
// background.js
chrome.action.onClicked.addListener((tab) => {
  chrome.pageCapture.saveAsMHTML({ tabId: tab.id }, (mhtmlData) => {
    const blob = new Blob([mhtmlData], { type: "application/mhtml" });
    const url = URL.createObjectURL(blob);
    chrome.downloads.download({
      url,
      filename: "page.mhtml"
    });
  });
});
```

---

### 2. **`chrome.contextMenus` - 自定义右键菜单**

**功能**：在网页右键菜单里加自定义项。

**示例**：

```jsonc
// manifest.json
{
  "name": "Context Menu Demo",
  "manifest_version": 3,
  "version": "1.0",
  "permissions": ["contextMenus", "tabs"],
  "background": {
    "service_worker": "background.js"
  }
}
```

```js
// background.js
chrome.runtime.onInstalled.addListener(() => {
  chrome.contextMenus.create({
    id: "sayHello",
    title: "对当前页面说 Hello",
    contexts: ["page"]
  });
});

chrome.contextMenus.onClicked.addListener((info, tab) => {
  if (info.menuItemId === "sayHello") {
    chrome.scripting.executeScript({
      target: { tabId: tab.id },
      func: () => alert("Hello from context menu!")
    });
  }
});
```

### 3. **`chrome.omnibox` - 地址栏命令交互**

**功能**：给地址栏注册一个关键字，当用户输入时提供补全建议。

**示例**：

```jsonc
// manifest.json
{
  "name": "Omnibox Demo",
  "manifest_version": 3,
  "version": "1.0",
  "omnibox": { "keyword": "gpt" },
  "background": {
    "service_worker": "background.js"
  }
}
```

```js
// background.js
chrome.omnibox.onInputChanged.addListener((text, suggest) => {
  suggest([
    { content: "chat " + text, description: "搜索 GPT 聊天: " + text },
    { content: "doc " + text, description: "搜索文档: " + text }
  ]);
});

chrome.omnibox.onInputEntered.addListener((text) => {
  chrome.tabs.create({ url: "https://www.google.com/search?q=" + encodeURIComponent(text) });
});
```

---

### 4. **`chrome.sidePanel` - 创建浏览器侧边栏**

**功能**：扩展可在浏览器侧边栏里展示 UI（类似 ChatGPT 插件侧栏）。

**示例**：

```jsonc
// manifest.json
{
  "name": "Side Panel Demo",
  "manifest_version": 3,
  "version": "1.0",
  "permissions": ["sidePanel"],
  "background": {
    "service_worker": "background.js"
  },
  "side_panel": {
    "default_path": "panel.html"
  }
}
```

```js
// background.js
chrome.runtime.onInstalled.addListener(() => {
  chrome.sidePanel.setOptions({
    path: "panel.html",
    enabled: true
  });
});
```

```html
<!-- panel.html -->
<!DOCTYPE html>
<html>
<body>
  <h2>我是扩展侧边栏</h2>
  <button onclick="alert('侧边栏按钮点击!')">点我</button>
</body>
</html>
```


### 5. **`chrome.commands` - 注册全局快捷键**

**功能**：扩展可以注册快捷键，即使页面没聚焦也能触发。

**示例**：

```jsonc
// manifest.json
{
  "name": "Commands Demo",
  "manifest_version": 3,
  "version": "1.0",
  "permissions": ["tabs", "scripting"],
  "background": {
    "service_worker": "background.js"
  },
  "commands": {
    "say-hello": {
      "suggested_key": {
        "default": "Ctrl+Shift+Y"
      },
      "description": "对当前页面说 Hello"
    }
  }
}
```

```js
// background.js
chrome.commands.onCommand.addListener((command) => {
  if (command === "say-hello") {
    chrome.tabs.query({ active: true, currentWindow: true }, (tabs) => {
      chrome.scripting.executeScript({
        target: { tabId: tabs[0].id },
        func: () => alert("Hello from shortcut!")
      });
    });
  }
});
```


### 6. **`chrome.declarativeNetRequest` - 声明式网络请求拦截**

**功能**：拦截或重定向请求（性能更好，适合广告拦截）。

**示例**（拦截某网站请求）：

```jsonc
// manifest.json
{
  "name": "DNR Demo",
  "manifest_version": 3,
  "version": "1.0",
  "permissions": ["declarativeNetRequest"],
  "host_permissions": ["*://*/*"],
  "declarative_net_request": {
    "rule_resources": [
      {
        "id": "ruleset_1",
        "enabled": true,
        "path": "rules.json"
      }
    ]
  }
}
```

```jsonc
// rules.json
[
  {
    "id": 1,
    "priority": 1,
    "action": { "type": "block" },
    "condition": { "urlFilter": "example.com", "resourceTypes": ["main_frame"] }
  }
]
```


### 7. **`chrome.webRequest` - 动态网络请求观测与修改**

（⚠️ 仅 MV2 或企业策略下启用，MV3 默认推荐 declarativeNetRequest）

**示例**（在请求头加自定义字段）：

```jsonc
// manifest.json
{
  "name": "WebRequest Demo",
  "manifest_version": 2,   // ⚠️ 必须 MV2
  "version": "1.0",
  "permissions": ["webRequest", "webRequestBlocking", "*://*/*"],
  "background": {
    "scripts": ["background.js"]
  }
}
```

```js
// background.js
chrome.webRequest.onBeforeSendHeaders.addListener(
  (details) => {
    details.requestHeaders.push({ name: "X-My-Header", value: "HelloWorld" });
    return { requestHeaders: details.requestHeaders };
  },
  { urls: ["<all_urls>"] },
  ["blocking", "requestHeaders"]
);
```

### 8. **`chrome.cookies` - 跨域 Cookie 管理**

**功能**：读取、设置、删除任意网站 Cookie。

**示例**：

```jsonc
// manifest.json
{
  "name": "Cookies Demo",
  "manifest_version": 3,
  "version": "1.0",
  "permissions": ["cookies", "tabs"],
  "host_permissions": ["https://*.example.com/*"],
  "background": {
    "service_worker": "background.js"
  }
}
```

```js
// background.js
chrome.action.onClicked.addListener(() => {
  // 获取 Cookie
  chrome.cookies.get({ url: "https://www.example.com", name: "session" }, (cookie) => {
    console.log("Cookie value:", cookie?.value);
  });

  // 设置 Cookie
  chrome.cookies.set({
    url: "https://www.example.com",
    name: "session",
    value: "my_value",
    expirationDate: Math.floor(Date.now() / 1000) + 3600
  });

  // 删除 Cookie
  chrome.cookies.remove({ url: "https://www.example.com", name: "session" });
});
```


### 9. **`chrome.webNavigation` - 导航状态监控**

**功能**：监听所有标签页的导航事件（开始、完成、错误等）。

**示例**：

```jsonc
// manifest.json
{
  "name": "WebNavigation Demo",
  "manifest_version": 3,
  "version": "1.0",
  "permissions": ["webNavigation"],
  "background": {
    "service_worker": "background.js"
  }
}
```

```js
// background.js
chrome.webNavigation.onCompleted.addListener((details) => {
  console.log("页面加载完成:", details.url);
});
```


### 10. **`chrome.nativeMessaging` - 与本地应用通信**

**功能**：和本地安装的程序（通过 manifest 注册）进行通信。

⚠️ 需要在 **操作系统层面安装一个本地应用**，并提供一个原生消息宿主 manifest（JSON）。浏览器扩展和本地程序通过 **stdin/stdout + JSON** 通信。

**扩展侧示例**：

```jsonc
// manifest.json
{
  "name": "NativeMessaging Demo",
  "manifest_version": 3,
  "version": "1.0",
  "permissions": ["nativeMessaging"],
  "background": {
    "service_worker": "background.js"
  }
}
```

```js
// background.js
let port = chrome.runtime.connectNative("com.example.my_app");

port.onMessage.addListener((msg) => {
  console.log("收到本地应用消息:", msg);
});

port.postMessage({ text: "Hello from extension" });
```


### 11. **`chrome.system.cpu/memory/storage` - 系统信息查询**

**功能**：获取 CPU、内存、磁盘等硬件信息。

**示例**：

```jsonc
// manifest.json
{
  "name": "System Info Demo",
  "manifest_version": 3,
  "version": "1.0",
  "permissions": ["system.cpu", "system.memory", "system.storage"],
  "background": {
    "service_worker": "background.js"
  }
}
```

```js
// background.js
chrome.system.cpu.getInfo((info) => {
  console.log("CPU info:", info);
});

chrome.system.memory.getInfo((info) => {
  console.log("Memory info:", info);
});

chrome.system.storage.getInfo((infoArray) => {
  console.log("Storage devices:", infoArray);
});
```

### 12. **`chrome.devtools.panels` - 创建新的开发者工具面板**

**功能**：在 DevTools 里添加一个新的面板。

**示例**：

```jsonc
// manifest.json
{
  "name": "DevTools Panel Demo",
  "manifest_version": 3,
  "version": "1.0",
  "devtools_page": "devtools.html"
}
```

```html
<!-- devtools.html -->
<script>
chrome.devtools.panels.create(
  "My Panel",        // 面板标题
  "",                // 图标，可留空
  "panel.html",      // 面板内容
  (panel) => {
    console.log("自定义 DevTools 面板已创建");
  }
);
</script>
```

```html
<!-- panel.html -->
<!DOCTYPE html>
<html>
<body>
  <h2>这是我的 DevTools 面板</h2>
  <button onclick="console.log('按钮点击')">点我</button>
</body>
</html>
```


### 13. **`chrome.devtools.inspectedWindow` - 与被检查页面交互**

**功能**：在 DevTools 面板中执行被检查页面的代码。

**示例**（接着上面的 `panel.html`）：

```html
<button onclick="injectCode()">执行页面代码</button>

<script>
function injectCode() {
  chrome.devtools.inspectedWindow.eval("document.title", (result, isException) => {
    if (!isException) alert("当前页面标题: " + result);
  });
}
</script>
```

### 14. **`chrome.devtools.network` - 访问网络请求详情**

**功能**：获取 Network 面板中的所有请求。

**示例**（放在 `panel.html` 里）：

```html
<script>
chrome.devtools.network.onRequestFinished.addListener((request) => {
  console.log("捕获请求:", request.request.url);
});
</script>
```


### 15. **`chrome.debugger` - 作为远程调试器附加到标签页**

**功能**：扩展附加到标签页，使用 Chrome DevTools Protocol (CDP) 调试。

**示例**：

```jsonc
// manifest.json
{
  "name": "Debugger Demo",
  "manifest_version": 3,
  "version": "1.0",
  "permissions": ["debugger", "tabs"],
  "background": {
    "service_worker": "background.js"
  }
}
```

```js
// background.js
chrome.action.onClicked.addListener((tab) => {
  const debuggee = { tabId: tab.id };

  chrome.debugger.attach(debuggee, "1.3", () => {
    console.log("已附加到页面");

    // 获取 DOM 文档结构
    chrome.debugger.sendCommand(debuggee, "DOM.getDocument", {}, (result) => {
      console.log("DOM:", result);
    });
  });
});
```


### 16. **`chrome.processes` - 监控浏览器进程**

（⚠️ 仅 Chrome 支持，部分平台可能不可用）

**示例**：

```jsonc
// manifest.json
{
  "name": "Processes Demo",
  "manifest_version": 3,
  "version": "1.0",
  "permissions": ["processes"],
  "background": {
    "service_worker": "background.js"
  }
}
```

```js
// background.js
chrome.processes.getProcessInfo([], true, (processes) => {
  console.log("浏览器进程信息:", processes);
});
```


### 17. **`chrome.tts` / `chrome.ttsEngine` - 提供或成为语音引擎**

**功能**：让扩展朗读文字，或注册为语音引擎。

**示例**（朗读文本）：

```jsonc
// manifest.json
{
  "name": "TTS Demo",
  "manifest_version": 3,
  "version": "1.0",
  "permissions": ["tts"],
  "background": {
    "service_worker": "background.js"
  }
}
```

```js
// background.js
chrome.action.onClicked.addListener(() => {
  chrome.tts.speak("你好，这是来自扩展的语音播报！", { rate: 1.0 });
});
```


### 18. **`chrome.search` - 以编程方式搜索**

**功能**：调用浏览器的默认搜索引擎搜索内容。

**示例**：

```jsonc
// manifest.json
{
  "name": "Search Demo",
  "manifest_version": 3,
  "version": "1.0",
  "permissions": ["search"],
  "background": {
    "service_worker": "background.js"
  }
}
```

```js
// background.js
chrome.action.onClicked.addListener(() => {
  chrome.search.query({ text: "OpenAI ChatGPT 插件开发" });
});
```
